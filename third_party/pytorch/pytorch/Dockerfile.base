FROM nvidia/cuda:10.0-cudnn7-devel-ubuntu18.04

ENV DEBIAN_FRONTEND=noninteractive
ARG INTEL_MKL_VERSION

RUN apt-get update && \
    apt-get install -y \
    cmake \
    curl \
    wget \
    git \
    zip \
    build-essential \
    libomp5 \
    libopenmpi-dev && \
    # install mkl
    wget https://apt.repos.intel.com/intel-gpg-keys/GPG-PUB-KEY-INTEL-SW-PRODUCTS-2019.PUB && \
    apt-key add GPG-PUB-KEY-INTEL-SW-PRODUCTS-2019.PUB && \
    rm GPG-PUB-KEY-INTEL-SW-PRODUCTS-2019.PUB && \
    wget https://apt.repos.intel.com/setup/intelproducts.list -O /etc/apt/sources.list.d/intelproducts.list && \
    apt-get update && \
    apt-get install -y $INTEL_MKL_VERSION && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*